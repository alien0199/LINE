<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Weather In Buri üå§Ô∏è</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;500;600&display=swap" rel="stylesheet">
    <style>
        /* ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å ‡∏™‡∏î‡πÉ‡∏™ ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏û‡∏≤‡∏™‡πÄ‡∏ó‡∏• (Auto Weather In Buri Theme) */
        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, #FFDEE9 0%, #B5FFFC 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 15px;
            color: #444;
        }

        .card {
            background: rgba(255, 255, 255, 0.90);
            backdrop-filter: blur(10px);
            border-radius: 35px;
            padding: 30px 20px;
            width: 100%;
            max-width: 380px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            border: 2px solid #fff;
        }

        .location-badge {
            background: #ff9a9e;
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 0.85em;
            font-weight: 500;
            display: inline-block;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(255, 154, 158, 0.4);
        }

        h1 { margin: 0; color: #555; font-size: 1.6em; font-weight: 600; }
        .timestamp { font-size: 0.8em; color: #888; margin-bottom: 25px; }

        /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
        .data-box {
            background: #ffffff;
            border-radius: 25px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: transform 0.2s;
        }
        .data-box:active { transform: scale(0.98); }

        .weather-icon img { width: 80px; height: 80px; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1)); }
        
        .temp-big { font-size: 2.8em; font-weight: bold; color: #4facfe; line-height: 1; }
        .weather-desc { font-size: 1em; color: #666; margin-top: 5px; }

        /* ‡∏™‡πà‡∏ß‡∏ô‡∏ù‡∏∏‡πà‡∏ô PM2.5 */
        .pm-label { font-size: 0.9em; color: #888; text-align: left; }
        .pm-value { font-size: 2.2em; font-weight: bold; color: #333; }
        .pm-unit { font-size: 0.5em; color: #999; font-weight: normal; }
        .pm-status { font-size: 0.9em; font-weight: 600; margin-top: 5px; }

        /* ‡∏™‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ù‡∏∏‡πà‡∏ô */
        .status-good { color: #00b894; }      /* ‡∏î‡∏µ‡∏°‡∏≤‡∏Å */
        .status-moderate { color: #fdcb6e; }  /* ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á */
        .status-bad { color: #ff7675; }       /* ‡πÅ‡∏¢‡πà */
        .status-vbad { color: #d63031; }      /* ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢ */

        /* ‡∏õ‡∏∏‡πà‡∏° Refresh */
        .btn-refresh {
            background: linear-gradient(45deg, #a18cd1, #fbc2eb);
            color: white;
            border: none;
            padding: 12px 40px;
            border-radius: 50px;
            font-size: 1em;
            cursor: pointer;
            margin-top: 10px;
            box-shadow: 0 5px 20px rgba(161, 140, 209, 0.4);
            font-family: 'Kanit', sans-serif;
            font-weight: 500;
        }
        .btn-refresh:hover { opacity: 0.9; }
    
        /* ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡∏∞‡∏û‡∏¥‡∏Å‡∏±‡∏î */
        .address {
            font-size: 0.85em;
            color: #666;
            margin-top: 6px;
            line-height: 1.35;
        }
        .coords {
            font-size: 0.78em;
            color: #888;
            margin-top: 6px;
        }
        .loc-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 12px 0 6px 0;
            flex-wrap: wrap;
        }
        .btn-small {
            padding: 10px 18px;
            border-radius: 50px;
            font-size: 0.95em;
        }
        .btn-secondary {
            background: linear-gradient(45deg, #43e97b, #38f9d7);
            box-shadow: 0 5px 20px rgba(67, 233, 123, 0.35);
        }
        .btn-ghost {
            background: rgba(255,255,255,0.6);
            color: #555;
            border: 1px solid rgba(0,0,0,0.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.06);
        }
        .map-link {
            display: inline-block;
            margin-top: 4px;
            font-size: 0.85em;
            color: #6c5ce7;
            text-decoration: none;
            font-weight: 500;
        }
        .map-link:hover { text-decoration: underline; }


        /* ‡∏õ‡∏£‡∏±‡∏ö badge ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß */
        .location-badge { max-width: 100%; white-space: normal; line-height: 1.25; }

</style>
</head>
<body>

    <div class="card">
        <div class="location-badge" id="loc-badge">üìç ‡∏´‡∏°‡∏π‡πà 6 ‡∏ï.‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå‡∏ö‡∏∏‡∏£‡∏µ</div>
        <h1>‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</h1>
        <div class="address" id="loc-address">‡∏´‡∏°‡∏π‡πà 6 ‡∏ï‡∏≥‡∏ö‡∏•‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå‡∏ö‡∏∏‡∏£‡∏µ ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå‡∏ö‡∏∏‡∏£‡∏µ ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ 16110</div>
        <div class="coords" id="loc-coords">‡∏û‡∏¥‡∏Å‡∏±‡∏î: --</div>
        <div class="timestamp" id="last-update">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
        <div class="loc-actions">
            <button class="btn-refresh btn-small btn-secondary" onclick="useGPS()">üì° ‡πÉ‡∏ä‡πâ GPS</button>
            <button class="btn-refresh btn-small btn-ghost" onclick="resetLocation()">‚Ü©Ô∏è ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</button>
        </div>
        <a class="map-link" id="map-link" href="#" target="_blank" rel="noopener">üó∫Ô∏è ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</a>

        <div class="data-box">
            <div style="text-align: left;">
                <div class="temp-big" id="temp">--¬∞</div>
                <div class="weather-desc" id="weather-desc">‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</div>
                <div style="font-size: 0.8em; color:#aaa; margin-top:5px;">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô: <span id="humidity">--</span>%</div>
            </div>
            <div class="weather-icon" id="weather-icon"></div>
        </div>

        <div class="data-box" style="display: block; text-align: center;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <span class="pm-label">‡∏ù‡∏∏‡πà‡∏ô PM 2.5</span>
                <span style="font-size: 1.5em;">üò∑</span>
            </div>
            <div class="pm-value" id="pm-val">-- <span class="pm-unit">Œºg/m¬≥</span></div>
            <div class="pm-status" id="pm-status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</div>
        </div>

        <button class="btn-refresh" onclick="fetchData()">üîÑ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</button>
    </div>

    <script>
        // --- üîí ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (Configuration) ---
        // ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô "‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå‡∏ö‡∏∏‡∏£‡∏µ" (‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å Google Maps)
        // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏´‡∏°‡∏π‡πà 6 ‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡πà‡∏≠‡∏¢‚Äî‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ "‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° üì° ‡πÉ‡∏ä‡πâ GPS
        const DEFAULT_LAT = 15.012146709989606;
        const DEFAULT_LON = 100.33121519335744;
        const DEFAULT_LABEL = '‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå‡∏ö‡∏∏‡∏£‡∏µ';

        let LAT = DEFAULT_LAT;
        let LON = DEFAULT_LON;

        const LOCATION_LABEL = '‡∏´‡∏°‡∏π‡πà 6 ‡∏ï.‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå‡∏ö‡∏∏‡∏£‡∏µ';
        const LOCATION_FULL = '‡∏´‡∏°‡∏π‡πà 6 ‡∏ï‡∏≥‡∏ö‡∏•‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå‡∏ö‡∏∏‡∏£‡∏µ ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå‡∏ö‡∏∏‡∏£‡∏µ ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ 16110';

        function mapUrl(lat, lon) {
            return `https://www.google.com/maps?q=${lat},${lon}`;
        }

        function updateLocationUI(extra = '') {
            document.getElementById('loc-badge').innerText = `üìç ${LOCATION_LABEL}`;
            document.getElementById('loc-address').innerText = LOCATION_FULL;
            document.getElementById('loc-coords').innerText = `‡∏û‡∏¥‡∏Å‡∏±‡∏î: ${LAT.toFixed(5)}, ${LON.toFixed(5)}${extra ? ' ‚Ä¢ ' + extra : ''}`;
            const link = document.getElementById('map-link');
            link.href = mapUrl(LAT, LON);
        }

        function setLocation(lat, lon, sourceText = '') {
            LAT = lat;
            LON = lon;
            // ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
            localStorage.setItem('customLat', String(LAT));
            localStorage.setItem('customLon', String(LON));
            updateLocationUI(sourceText);
        }

        function resetLocation() {
            localStorage.removeItem('customLat');
            localStorage.removeItem('customLon');
            LAT = DEFAULT_LAT;
            LON = DEFAULT_LON;
            updateLocationUI(DEFAULT_LABEL);
            fetchData();
        }

        function useGPS() {
            if (!navigator.geolocation) {
                alert('‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå/‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö GPS');
                return;
            }
            document.getElementById('last-update').innerText = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á GPS...';
            navigator.geolocation.getCurrentPosition(
                (pos) => {
                    const lat = pos.coords.latitude;
                    const lon = pos.coords.longitude;
                    const acc = pos.coords.accuracy ? Math.round(pos.coords.accuracy) : null;
                    setLocation(lat, lon, acc ? `GPS ¬±${acc}m` : 'GPS');
                    fetchData();
                },
                (err) => {
                    console.error('GPS Error:', err);
                    alert('‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏•‡∏≠‡∏á‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï Location ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡πÉ‡∏´‡∏°‡πà)');
                    updateLocationUI(DEFAULT_LABEL);
                },
                {
                    enableHighAccuracy: true,
                    timeout: 12000,
                    maximumAge: 60000
                }
            );
        }

        // ‡πÇ‡∏´‡∏•‡∏î‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
        const savedLat = parseFloat(localStorage.getItem('customLat'));
        const savedLon = parseFloat(localStorage.getItem('customLon'));
        if (!Number.isNaN(savedLat) && !Number.isNaN(savedLon)) {
            LAT = savedLat;
            LON = savedLon;
        }
        updateLocationUI(LAT === DEFAULT_LAT && LON === DEFAULT_LON ? DEFAULT_LABEL : '‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ');


        const WEATHER_CODE_TH = {
            0: "‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á",
            1: "‡∏°‡∏µ‡πÄ‡∏°‡∏Ü‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢",
            2: "‡∏°‡∏µ‡πÄ‡∏°‡∏Ü‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô",
            3: "‡πÄ‡∏°‡∏Ü‡∏°‡∏≤‡∏Å",
            45: "‡∏´‡∏°‡∏≠‡∏Å",
            48: "‡∏´‡∏°‡∏≠‡∏Å (‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏Ñ‡πâ‡∏≤‡∏á‡πÅ‡∏Ç‡πá‡∏á)",
            51: "‡∏•‡∏∞‡∏≠‡∏≠‡∏á‡∏ù‡∏ô‡πÄ‡∏ö‡∏≤",
            53: "‡∏•‡∏∞‡∏≠‡∏≠‡∏á‡∏ù‡∏ô‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á",
            55: "‡∏•‡∏∞‡∏≠‡∏≠‡∏á‡∏ù‡∏ô‡∏´‡∏ô‡∏±‡∏Å",
            56: "‡∏ù‡∏ô‡πÄ‡∏¢‡∏∑‡∏≠‡∏Å‡πÅ‡∏Ç‡πá‡∏á‡πÄ‡∏ö‡∏≤",
            57: "‡∏ù‡∏ô‡πÄ‡∏¢‡∏∑‡∏≠‡∏Å‡πÅ‡∏Ç‡πá‡∏á‡∏´‡∏ô‡∏±‡∏Å",
            61: "‡∏ù‡∏ô‡πÄ‡∏ö‡∏≤",
            63: "‡∏ù‡∏ô‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á",
            65: "‡∏ù‡∏ô‡∏´‡∏ô‡∏±‡∏Å",
            66: "‡∏ù‡∏ô‡πÄ‡∏¢‡∏∑‡∏≠‡∏Å‡πÅ‡∏Ç‡πá‡∏á‡πÄ‡∏ö‡∏≤",
            67: "‡∏ù‡∏ô‡πÄ‡∏¢‡∏∑‡∏≠‡∏Å‡πÅ‡∏Ç‡πá‡∏á‡∏´‡∏ô‡∏±‡∏Å",
            71: "‡∏´‡∏¥‡∏°‡∏∞‡πÄ‡∏ö‡∏≤",
            73: "‡∏´‡∏¥‡∏°‡∏∞‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á",
            75: "‡∏´‡∏¥‡∏°‡∏∞‡∏´‡∏ô‡∏±‡∏Å",
            77: "‡πÄ‡∏°‡πá‡∏î‡∏´‡∏¥‡∏°‡∏∞",
            80: "‡∏ù‡∏ô‡πÇ‡∏õ‡∏£‡∏¢‡πÄ‡∏ö‡∏≤",
            81: "‡∏ù‡∏ô‡πÇ‡∏õ‡∏£‡∏¢‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á",
            82: "‡∏ù‡∏ô‡πÇ‡∏õ‡∏£‡∏¢‡∏´‡∏ô‡∏±‡∏Å",
            85: "‡∏´‡∏¥‡∏°‡∏∞‡πÇ‡∏õ‡∏£‡∏¢‡πÄ‡∏ö‡∏≤",
            86: "‡∏´‡∏¥‡∏°‡∏∞‡πÇ‡∏õ‡∏£‡∏¢‡∏´‡∏ô‡∏±‡∏Å",
            95: "‡∏û‡∏≤‡∏¢‡∏∏‡∏ù‡∏ô‡∏ü‡πâ‡∏≤‡∏Ñ‡∏∞‡∏ô‡∏≠‡∏á",
            96: "‡∏û‡∏≤‡∏¢‡∏∏‡∏ù‡∏ô‡∏ü‡πâ‡∏≤‡∏Ñ‡∏∞‡∏ô‡∏≠‡∏á (‡∏•‡∏π‡∏Å‡πÄ‡∏´‡πá‡∏ö‡πÄ‡∏•‡πá‡∏Å)",
            99: "‡∏û‡∏≤‡∏¢‡∏∏‡∏ù‡∏ô‡∏ü‡πâ‡∏≤‡∏Ñ‡∏∞‡∏ô‡∏≠‡∏á (‡∏•‡∏π‡∏Å‡πÄ‡∏´‡πá‡∏ö‡∏´‡∏ô‡∏±‡∏Å)"
        };

        async function fetchJson(url, timeoutMs = 12000) {
            const controller = new AbortController();
            const t = setTimeout(() => controller.abort(), timeoutMs);
            try {
                const res = await fetch(url, { signal: controller.signal });
                const data = await res.json().catch(() => null);
                if (!res.ok) {
                    const reason = data?.reason || data?.error || data?.message || `HTTP ${res.status}`;
                    throw new Error(reason);
                }
                return data;
            } finally {
                clearTimeout(t);
            }
        }

        async function fetchData() {
            const updateTime = new Date().toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' });
            document.getElementById('last-update').innerText = `‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${updateTime} ‡∏ô.`;

            // 1) ‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏® (Open-Meteo: ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ API Key)
            try {
                const weatherUrl = `https://api.open-meteo.com/v1/forecast?latitude=${LAT}&longitude=${LON}&current=temperature_2m,relative_humidity_2m,weather_code&timezone=Asia%2FBangkok`;
                const wData = await fetchJson(weatherUrl);

                const temp = wData?.current?.temperature_2m;
                const humidity = wData?.current?.relative_humidity_2m;
                const code = wData?.current?.weather_code;

                if (typeof temp !== "number") throw new Error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥");
                document.getElementById('temp').innerText = Math.round(temp) + "¬∞";

                if (typeof humidity === "number") {
                    document.getElementById('humidity').innerText = Math.round(humidity) + "%";
                } else {
                    document.getElementById('humidity').innerText = "--%";
                }

                const desc = (code in WEATHER_CODE_TH) ? WEATHER_CODE_TH[code] : `‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≤‡∏Å‡∏≤‡∏®: ${code ?? "-"}`;
                document.getElementById('weather-desc').innerText = desc;
            } catch (error) {
                console.error("Weather Error:", error);
                document.getElementById('temp').innerText = "--¬∞";
                document.getElementById('humidity').innerText = "--%";
                document.getElementById('weather-desc').innerText = "‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ";
            }

            // 2) ‡∏ù‡∏∏‡πà‡∏ô PM2.5 (Open-Meteo Air Quality: ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ API Key)
            try {
                const airUrl = `https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${LAT}&longitude=${LON}&current=pm2_5&timezone=Asia%2FBangkok`;
                const airData = await fetchJson(airUrl);

                const pm25 = airData?.current?.pm2_5;
                if (typeof pm25 !== "number") throw new Error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡πà‡∏≤ PM2.5");

                const pm = Math.round(pm25);

                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤
                const pmEl = document.getElementById('pm-val');
                if (pmEl) pmEl.innerHTML = `${pm} <span class="pm-unit">Œºg/m¬≥</span>`;

                // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (‡∏™‡∏µ)
                const statusEl = document.getElementById('pm-status');
                if (statusEl) {
                    let label = "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡πâ‡∏ß";
                    statusEl.classList.remove('status-good','status-moderate','status-bad','status-vbad');

                    // ‡πÅ‡∏ö‡πà‡∏á‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ ‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏£‡πá‡∏ß (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£)
                    if (pm <= 10) { label = "‡∏î‡∏µ‡∏°‡∏≤‡∏Å"; statusEl.classList.add('status-good'); }
                    else if (pm <= 25) { label = "‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á"; statusEl.classList.add('status-moderate'); }
                    else if (pm <= 50) { label = "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û"; statusEl.classList.add('status-bad'); }
                    else { label = "‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢"; statusEl.classList.add('status-vbad'); }

                    statusEl.innerText = label;
                }
            } catch (error) {
                console.error("Air Quality Error:", error);
                const pmEl = document.getElementById('pm-val');
                if (pmEl) pmEl.innerHTML = `-- <span class="pm-unit">Œºg/m¬≥</span>`;
                const statusEl = document.getElementById('pm-status');
                if (statusEl) {
                    statusEl.classList.remove('status-good','status-moderate','status-bad','status-vbad');
                    statusEl.innerText = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ù‡∏∏‡πà‡∏ô";
                }
            }
        }

        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö
        fetchData();
    </script>
</body>
</html>
